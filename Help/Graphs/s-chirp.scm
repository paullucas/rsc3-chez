;; s-chirp (rd)

(let* ((x (MouseX kr 15 0 0 0.1))
       (y (MouseY kr 15 27 0 0.1))
       (scl (list 0 2 3.2 5 7 9 10))
       (t (Dust kr 9))
       (b (TChoose t (make-mce (list 36 48 60 72))))
       (n (Mul (LFNoise1 kr (mce2 3 3.05)) 0.04))
       (d (TIRand x y t))
       (e (Decay2 t 0.005 (TRand 0.02 0.15 t)))
       (k (DegreeToKey 0 d 12))
       (f (MIDICPS (Add3 b k n)))
       (m (Mul3 e (SinOsc ar f 0) 0.2))
       (u (PulseDivider t 9 0))
       (r0 (TRand 0.0075 0.125 u))
       (r1 (TRand 0.05 0.15 u))
       (o (MulAdd m 0.5 (AllpassC m 0.15 r0 r1))))
  (with-sc3
   (lambda (fd)
     (async fd (/b_alloc 0 7 1))
     (send fd (/b_setn1 0 0 scl))
     (audition (Out 0 o)))))
