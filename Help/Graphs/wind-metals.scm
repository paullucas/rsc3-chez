;; wind metals (jmcc)

(let* ((n 6)
       (base (ExpRand 60 4000))
       (range (Rand 500 8000))
       (n0 (clone 2 (BrownNoise ar)))
       (r0 (ExpRand 0.125 0.5))
       (n1 (LFNoise1 kr r0))
       (f (replicate-m n (Rand base (Add base range))))
       (dt (replicate-m n (Rand 0.1 2)))
       (exc (Mul3 n0 0.007 (Max 0 (MulAdd n1 0.75 0.25))))
       (k (klank-data f (replicate n 1) dt))
       (s (Klank exc 1 0 1 k)))
  (audition (Out 0 (SoftClip (Mul s 0.1)))))
